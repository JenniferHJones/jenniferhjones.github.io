<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Giphy Fun!</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
    <link rel="reset" type="text/css" href="../../reset.css">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Philosopher:400,700" rel="stylesheet">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="navbar-brand">Jennifer Jones</div>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a href="../../index.html" class="nav-link">About</a>
                </li>
                <li class="nav-item active">
                    <a href="../../portfolio.html" class="nav-link">Portfolio</a>
                </li>
                <li class="nav-item">
                    <a href="../../contact.html" class="nav-link">Contact</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="card text-center">
            <h1 class="card-header text-primary">Sports Fails</h1>
            <div class="card-body border border-primary">
                <h3 class="card-title">Not especially graceful? You are not alone!</h3>
                <p class="card-text">Click a button to view 10 gifs for that sport. Click once on a picture to animate it
                    then click again to make it stop.</p>
                <div id="buttons"></div>
    
                <form id="add-form">
                    <button type="button" class="btn btn-primary moreImages" id="add-gif">Click for More GIFs</button>
                    <br>
                    <label for="sport-input">Add a button:</label>
                    <input type="text" id="sport-input">
                    <button type="button" class="btn btn-primary btn-sm" id="add-sport">Submit</button>
                </form>
            </div>
        </div>
    <div class="container">
        <div id="images"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

        var topics = ["Basketball", "Boxing", "Golf", "Skiing", "Karate", "Rowing", "Sailing", "Swimming", "Tennis", "Volleyball"];

        function buttons() {
            $("#buttons").empty();
            for (var i = 0; i < topics.length; i++) {
                var b = $("<button class='btn btn-outline-primary'>");
                b.addClass("sport-btn");
                b.attr("data-name", topics[i]);
                b.text(topics[i]);
                $("#buttons").append(b);
            }
        };

        buttons();

        $("#add-sport").on("click", function (event) {
            event.preventDefault();
            var sport = $("#sport-input").val().trim();
            topics.push(sport);
            buttons();
        });

        $(document).on("click", ".sport-btn", displayImages);

        function displayImages() {
            $("#images").empty();
            var sport = $(this).attr("data-name");
            var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=UlsGZGJN2JtxEIbf0FazuLxh7m2ASR2x&q=" + sport + "+fail&rating=&limit=10";
            var queryURLmore = queryURL + "&offset=10";

            $.ajax({
                url: queryURL,
                method: "GET"
            }).then(function (response) {
                console.log(response);
                for (var i = 0; i < response.data.length; i++) {
                    var sportDiv = $("<div>");
                    var p = $("<p>").text("Title:  " + response.data[i].title + ", " + "Source: " + response.data[i].source_tld + ", " + "Rating: " + response.data[i].rating);
                    sportDiv.append(p);
                    var image = $("<img data-state='still' class='sport mb-5'>").attr("src", response.data[i].images.fixed_height_still.url);
                    image.attr("data-still", response.data[i].images.fixed_height_still.url);
                    image.attr("data-animate", response.data[i].images.fixed_height.url);
                    sportDiv.append(image);
                    $("#images").append(sportDiv);
                }
                $(".sport").on("click", function () {
                    console.log("click");
                    var state = $(this).attr("data-state");
                    if (state === "still") {
                        var animateURL = $(this).attr("data-animate");
                        $(this).attr('src', animateURL);
                        $(this).attr('data-state', 'animate');
                    } else {
                        $(this).attr('src', $(this).attr('data-still'));
                        $(this).attr('data-state', "still");
                    }
                });
            })
            $(document).on("click", ".moreImages", displayMoreImages);

            function displayMoreImages() {
                $.ajax({
                    url: queryURLmore,
                    method: "GET"
                }).then(function (response) {
                    for (var i = 0; i < response.data.length; i++) {
                        var sportDiv = $("<div>");
                        var p = $("<p>").text("Title:  " + response.data[i].title + ", " + "Source: " + response.data[i].source_tld + ", " + "Rating: " + response.data[i].rating);
                        sportDiv.append(p);
                        var image = $("<img data-state='still' class='sport mb-5'>").attr("src", response.data[i].images.fixed_height_still.url);
                        image.attr("data-still", response.data[i].images.fixed_height_still.url);
                        image.attr("data-animate", response.data[i].images.fixed_height.url);
                        sportDiv.append(image);
                        $("#images").append(sportDiv);
                    }
                    $(".sport").on("click", function () {
                        console.log("click");
                        var state = $(this).attr("data-state");
                        if (state === "still") {
                            var animateURL = $(this).attr("data-animate");
                            $(this).attr('src', animateURL);
                            $(this).attr('data-state', 'animate');
                        } else {
                            $(this).attr('src', $(this).attr('data-still'));
                            $(this).attr('data-state', "still");
                        }
                    });
                });
            }
        };
    </script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
</body>

</html>